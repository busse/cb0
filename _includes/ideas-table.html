{%- comment -%}
  Ideas table component for home page
  Displays all ideas with detailed progress information
{%- endcomment -%}
{%- assign sorted_ideas = site.ideas | sort: "idea_number" -%}
{%- if sorted_ideas.size > 0 -%}
  <div class="ideas-table-wrapper">
    <table class="ideas-table">
      <thead>
        <tr>
          <th class="ideas-table__notation">NOT</th>
          <th class="ideas-table__title">TITLE</th>
          <th class="ideas-table__status">STATUS</th>
          <th class="ideas-table__stories">STORIES</th>
          <th class="ideas-table__progress">PROGRESS</th>
          <th class="ideas-table__story-status">STORY STATUS</th>
          <th class="ideas-table__created">CREATED</th>
        </tr>
      </thead>
      <tbody>
        {%- for idea in sorted_ideas -%}
          {%- include helpers/stories-for-idea.html idea_number=idea.idea_number -%}
          {%- assign idea_stories = stories_list -%}
          {%- assign total_stories = idea_stories | size -%}
          
          {%- comment -%} Count stories by status {%- endcomment -%}
          {%- assign done_stories = idea_stories | where: "status", "done" | size -%}
          {%- assign in_progress_stories = idea_stories | where: "status", "in_progress" | size -%}
          {%- assign in_progress_stories_alt = idea_stories | where: "status", "in-progress" | size -%}
          {%- assign in_progress_stories = in_progress_stories | plus: in_progress_stories_alt -%}
          {%- assign backlog_stories = idea_stories | where: "status", "backlog" | size -%}
          {%- assign planned_stories = idea_stories | where: "status", "planned" | size -%}
          
          {%- comment -%} Calculate progress percentage {%- endcomment -%}
          {%- if total_stories > 0 -%}
            {%- assign progress_pct = done_stories | times: 100.0 | divided_by: total_stories | round -%}
          {%- else -%}
            {%- assign progress_pct = 0 -%}
          {%- endif -%}
          
          {%- comment -%} Build story status string {%- endcomment -%}
          {%- assign status_parts = "" -%}
          {%- if done_stories > 0 -%}
            {%- if status_parts != "" -%}
              {%- assign status_parts = status_parts | append: ", " -%}
            {%- endif -%}
            {%- assign status_parts = status_parts | append: done_stories | append: " done" -%}
          {%- endif -%}
          {%- if in_progress_stories > 0 -%}
            {%- if status_parts != "" -%}
              {%- assign status_parts = status_parts | append: ", " -%}
            {%- endif -%}
            {%- assign status_parts = status_parts | append: in_progress_stories | append: " active" -%}
          {%- endif -%}
          {%- if backlog_stories > 0 -%}
            {%- if status_parts != "" -%}
              {%- assign status_parts = status_parts | append: ", " -%}
            {%- endif -%}
            {%- assign status_parts = status_parts | append: backlog_stories | append: " backlog" -%}
          {%- endif -%}
          {%- if planned_stories > 0 -%}
            {%- if status_parts != "" -%}
              {%- assign status_parts = status_parts | append: ", " -%}
            {%- endif -%}
            {%- assign status_parts = status_parts | append: planned_stories | append: " planned" -%}
          {%- endif -%}
          {%- if status_parts == "" -%}
            {%- assign status_parts = "â€”" -%}
          {%- endif -%}
          
          <tr class="ideas-table__row">
            <td class="ideas-table__notation">
              {% include notation-badge.html idea=idea.idea_number size="sm" %}
            </td>
            <td class="ideas-table__title">
              <a href="{{ idea.url | relative_url }}" class="ideas-table__title-link">{{ idea.title }}</a>
            </td>
            <td class="ideas-table__status">
              <span class="status-indicator status-indicator--{{ idea.status }}">{{ idea.status | upcase }}</span>
            </td>
            <td class="ideas-table__stories">
              {{ total_stories }}
            </td>
            <td class="ideas-table__progress">
              <div class="ideas-table__progress-container">
                <span class="ideas-table__progress-text">{{ progress_pct }}%</span>
                <div class="ideas-table__progress-bar">
                  <div class="ideas-table__progress-fill" style="width: {{ progress_pct }}%;"></div>
                </div>
              </div>
            </td>
            <td class="ideas-table__story-status">
              {{ status_parts }}
            </td>
            <td class="ideas-table__created">
              <time datetime="{{ idea.created }}">{{ idea.created | date: "%Y-%m-%d" }}</time>
            </td>
          </tr>
        {%- endfor -%}
      </tbody>
    </table>
  </div>
{%- else -%}
  <p class="ideas-table__empty-message">No ideas yet. Create your first idea to get started.</p>
{%- endif -%}

