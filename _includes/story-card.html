{%- comment -%}
  Card component for displaying a story in list/grid views
  Parameters:
    - story: The story object from site.stories
{%- endcomment -%}
{%- assign story = include.story -%}
{%- assign story_ideas = story.related_ideas | default: "" -%}
{%- if story_ideas == "" or story_ideas == nil -%}
  {%- assign story_ideas = "" | split: "" -%}
{%- endif -%}
{%- assign primary_sprint = story.related_sprints | first -%}

<article class="story-card story-card--{{ story.status }}" 
         data-story="{{ story.story_number }}"
         data-status="{{ story.status }}"
         data-priority="{{ story.priority }}"
         data-sprints="{{ story.related_sprints | join: ',' }}"
         data-ideas="{{ story.related_ideas | join: ',' }}">
  <header class="story-card__header">
    <div class="story-card__ideas">
      {%- if story_ideas.size > 0 -%}
        {%- for idea_number in story_ideas -%}
          {% include notation-badge.html idea=idea_number story=story.story_number size="sm" %}
        {%- endfor -%}
      {%- else -%}
        <span class="notation-badge notation-badge--sm">s{{ story.story_number }}</span>
      {%- endif -%}
    </div>
    <span class="priority-indicator priority-indicator--{{ story.priority }}">{{ story.priority | upcase }}</span>
  </header>
  
  <h4 class="story-card__title">
    <a href="{{ story.url | relative_url }}">{{ story.title }}</a>
  </h4>
  
  <p class="story-card__description">{{ story.description | truncate: 120 }}</p>
  
  <footer class="story-card__meta">
    <span class="status-indicator status-indicator--{{ story.status }}">{{ story.status | replace: "-", " " | upcase }}</span>
    {%- if primary_sprint -%}
      <span class="story-card__sprint">{% include notation-badge.html sprint=primary_sprint size="sm" %}</span>
    {%- else -%}
      <span class="story-card__sprint story-card__sprint--backlog">Backlog</span>
    {%- endif -%}
  </footer>
</article>

