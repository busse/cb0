{%- comment -%}
  Usage: {% include helpers/updates-for-story.html story=page %}
  Sets: story_updates variable
  Parameters:
    - story: The story object
{%- endcomment -%}
{%- assign target_story = include.story -%}
{%- assign story_number = include.story_number | default: target_story.story_number -%}
{%- assign idea_numbers = include.idea_numbers | default: target_story.related_ideas -%}
{%- if idea_numbers == nil or idea_numbers == "" -%}
  {%- assign fallback_idea = include.idea_number -%}
  {%- if fallback_idea != nil -%}
    {%- assign idea_numbers = "" | split: "" | push: fallback_idea | uniq -%}
  {%- else -%}
    {%- assign idea_numbers = "" | split: "" -%}
  {%- endif -%}
{%- endif -%}
{%- assign story_updates = site.updates | where: "story_number", story_number -%}
{%- assign story_updates = story_updates | where_exp: "update", "idea_numbers contains update.idea_number" | sort: "date" | reverse -%}

